<!DOCTYPE html>
<html>
  <head>
    <title>Email Subscription Form</title>
  </head>
  <body>
    <form id="subscribe-form">
      <label for="email">Enter your email address:</label><br>
      <input type="email" id="email" name="email" required><br>
      <button type="submit" onclick="subscribe()">Subscribe</button>
    </form>
    
    <script src="https://unpkg.com/deta@latest/lib/deta.js"></script>
    <script>
      const deta = Deta("project key");
      const db = deta.Base("simple_db");
      
      async function subscribe() {
        // Get the email address
        var email = document.getElementById("email").value;
        
        // Validate the email address (optional)
        if (!validateEmail(email)) {
          alert("Please enter a valid email address.");
          return;
        }
        
        // Store the email address in Deta
        await db.put({ email: email });
        
        // Show a success message
        alert("You have been successfully subscribed!");
      }
      
      function validateEmail(email) {
        // This is a basic email validation check.
        // You can modify this function to fit your needs.
        var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(String(email).toLowerCase());
      }
    </script>
  </body>
</html>
